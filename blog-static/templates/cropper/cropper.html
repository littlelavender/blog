<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.bootcss.com/cropperjs/1.5.1/cropper.css">
  <link rel="stylesheet" href="../../static/font-awesome-4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="main.css">
</head>
<body>

  <div class="container">
    <div class="row">
      <div class="col-md-9">
        <div class="img-container">
          <img id="image" class="" src="../../static/images/picture.jpg">
        </div>
      </div>
      <div class="col-md-3">
        <div>
          <div class="img-preview preview-lg" style=""></div>
          <div class="img-preview preview-md" style=""></div>
          <div class="img-preview preview-sm" style=""></div>
          <div class="img-preview preview-xs" style=""></div>
        </div>
        <div class="docs-data">
          <div class="input-group input-group-sm">
            <span class="input-group-prepend">
              <label class="input-group-text">X</label>
            </span>
            <input class="form-control" id="cropper-x" value="0">
            <span class="input-group-append">
              <label class="input-group-text">px</label>
            </span>
          </div>
          <div class="input-group input-group-sm">
            <span class="input-group-prepend">
              <label class="input-group-text">Y</label>
            </span>
            <input class="form-control" id="cropper-y" value="0">
            <span class="input-group-append">
              <label class="input-group-text">px</label>
            </span>
          </div>
          <div class="input-group input-group-sm">
            <span class="input-group-prepend">
              <label class="input-group-text">Width</label>
            </span>
            <input class="form-control" id="cropper-width" value="0">
            <span class="input-group-append">
              <label class="input-group-text">px</label>
            </span>
          </div>
          <div class="input-group input-group-sm">
            <span class="input-group-prepend">
              <label class="input-group-text">Height</label>
            </span>
            <input class="form-control" id="cropper-height" value="0">
            <span class="input-group-append">
              <label class="input-group-text">px</label>
            </span>
          </div>
          <div class="input-group input-group-sm">
            <span class="input-group-prepend">
              <label class="input-group-text">Rotate</label>
            </span>
            <input class="form-control" id="cropper-rotate" value="0">
            <span class="input-group-append">
              <label class="input-group-text">deg</label>
            </span>
          </div>
          <div class="input-group input-group-sm">
            <span class="input-group-prepend">
              <label class="input-group-text">ScaleX</label>
            </span>
            <input class="form-control" id="cropper-scalex" value="0">
          </div>
          <div class="input-group input-group-sm">
            <span class="input-group-prepend">
              <label class="input-group-text">ScaleY</label>
            </span>
            <input class="form-control" id="cropper-scaley" value="0">
          </div>
        </div>
      </div>

    </div>
    <div class="row">
      <div class="col-md-9 docs-buttons">
        <!--<button class="btn btn-outline-primary" id="getData">测试</button>-->
        <div class="btn-group">
          <button class="btn btn-primary" id="button-mode-arrow"><span class="fa fa-arrows"></span></button>
          <button class="btn btn-primary" id="button-mode-crop"><span class="fa fa-crop"></span></button>
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" id="button-zoom-plus"><span class="fa fa-search-plus"></span></button>
          <button class="btn btn-primary" id="button-zoom-minus"><span class="fa fa-search-minus"></span></button>
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" id="button-move-left"><span class="fa fa-arrow-left"></span></button>
          <button class="btn btn-primary" id="button-move-right"><span class="fa fa-arrow-right"></span></button>
          <button class="btn btn-primary" id="button-move-up"><span class="fa fa-arrow-up"></span></button>
          <button class="btn btn-primary" id="button-move-down"><span class="fa fa-arrow-down"></span></button>
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" id="button-rotate-left"><span class="fa fa-rotate-left"></span></button>
          <button class="btn btn-primary" id="button-rotate-right"><span class="fa fa-rotate-right"></span></button>
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" id="button-scalex"><span class="fa fa-arrows-h"></span></button>
          <button class="btn btn-primary" id="button-scaley"><span class="fa fa-arrows-v"></span></button>
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" id="button-crop"><span class="fa fa-check"></span></button>
          <button class="btn btn-primary" id="button-clear"><span class="fa fa-remove"></span></button>
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" id="button-disable"><span class="fa fa-lock"></span></button>
          <button class="btn btn-primary" id="button-enable"><span class="fa fa-unlock"></span></button>
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" id="button-reset"><span class="fa fa-refresh"></span></button>
          <button class="btn btn-primary" id="btn-upload"><span class="fa fa-upload"></span></button>
          <button class="btn btn-primary" id="button-destroy"><span class="fa fa-power-off"></span></button>
          <input type="file"  id="inputImage" style="display: none" accept=".jpg,.jpeg,.png,.gif,.bmp,.tiff">
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js"></script>
  <script src="https://cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  <!-- cropper -->
  <script src="https://cdn.bootcss.com/cropperjs/1.5.1/cropper.js"></script>
  <script>
      const image = document.getElementById("image")

      var cropper = new Cropper(image, {
          aspectRatio: NaN,
          viewMode: 0,
          preview: '.img-preview',
          crop: function (e) {
              changeCropper()
          }
      })

      // cropBox 移动时获取 crop 的数据并同步到 右侧数据栏
      var changeCropper = function () {
          $('#cropper-x').val(Math.round(cropper.getData().x))
          $('#cropper-y').val(Math.round(cropper.getData().y))
          $('#cropper-width').val(Math.round(cropper.getData().width))
          $('#cropper-height').val(Math.round(cropper.getData().height))
          $('#cropper-rotate').val(cropper.getData().rotate)
          $('#cropper-scalex').val(cropper.getData().scaleX)
          $('#cropper-scaley').val(cropper.getData().scaleY)
      }

      $('#button-mode-arrow').on('click', function() {
          cropper.setDragMode('move')
      })
      $('#button-mode-crop').on('click', function() {
          cropper.setDragMode('crop')
      })
      $('#button-zoom-plus').on('click', function() {
          cropper.zoom(0.1)
      })
      $('#button-zoom-minus').on('click', function() {
          cropper.zoom(-0.1)
      })
      $('#button-move-left').on('click', function() {
          cropper.move(-10, 0)
      })
      $('#button-move-right').on('click', function() {
          cropper.move(10, 0)
      })
      $('#button-move-up').on('click', function() {
          cropper.move(0, -10)
      })
      $('#button-move-down').on('click', function() {
          cropper.move(0, 10)
      })
      $('#button-rotate-left').on('click', function() {
          cropper.rotate(-45)
      })
      $('#button-rotate-right').on('click', function() {
          cropper.rotate(45)
      })
      $('#button-scalex').on('click', function() {
          var x = cropper.getData().scaleX; //获取原本的 scaleX 取反
          cropper.scaleX(-x)
      })
      $('#button-scaley').on('click', function() {
          cropper.scaleY(-(cropper.getData().scaleY))
      })
      $('#button-crop').on('click', function() {
          cropper.crop()
      })
      $('#button-clear').on('click', function() {
          cropper.clear()
      })
      $('#button-disable').on('click', function() {
          cropper.disable()
      })
      $('#button-enable').on('click', function() {
          cropper.enable()
      })
      $('#button-reset').on('click', function() {
          cropper.reset()
      })
      $('#btn-upload').on('click', function() {
          $('#inputImage').click()
      })
      $('#button-destroy').on('click', function() {
          cropper.destroy()
      })
      // 选择本地图片
      $('#inputImage').on('change', function () {
          var files = this.files;
          var file;
          var URL;
          var uploadedImageURL;
          if(files && files.length) {
              file = files[0];

              if (uploadedImageURL) {
                  URL.revokeObjectURL(uploadedImageURL);
              }

              URL = window.URL;
              uploadedImageURL = URL.createObjectURL(file);

              cropper.replace(uploadedImageURL)
          }
          $('#inputImage').val('')
      })
  </script>
</body>
</html>